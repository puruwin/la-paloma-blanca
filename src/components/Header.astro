---
import "../styles/global.css";
import LanguageSelector from "./LanguageSelector.astro";

const { content, lang } = Astro.props;

const menuItems = [
  {
    id: "services",
    label: content.services.title,
  },
  {
    id: "about-us",
    label: content.about.title,
  },
  {
    id: "how-we-work",
    label: content.howWeWork.title,
  },
  {
    id: "contact",
    label: content.contact.title,
  },
];
---

<header
  class="bg-white border-b border-default fixed w-full top-0 z-50 lg:h-16 sm:h-12"
>
  <div class="max-w-7xl mx-auto h-full grid grid-cols-3 items-center px-4">
    <div
      class="col-start-2 sm:col-start-1 flex justify-center sm:justify-start"
    >
      <a href="/">
        <img
          src="/logo-paloma-deep.svg"
          alt="La Paloma Blanca Entertainment"
          class="w-10 h-10"
        />
      </a>
    </div>
    <div class="col-start-3 flex justify-end">
      <nav class="h-full flex items-center">
        <button
          id="menu-toggle"
          class="sm:hidden text-2xl p-2 text-default"
          aria-label="Abrir menú">☰</button
        >
        <ul
          id="main-menu"
          class="hidden sm:flex flex-col sm:flex-row absolute min-h-12 sm:static top-12 right-4 bg-white sm:bg-transparent border sm:border-0 rounded sm:rounded-none shadow-lg sm:shadow-none p-4 sm:p-0 z-50 font-medium font-sans items-center gap-8"
        >
          {
            menuItems.map((item) => (
              <li>
                <a
                  href={`#${item.id}`}
                  class="text-[var(--text-primary)] hover:text-[var(--text-secondary)] whitespace-nowrap block py-2 px-4 menu-link"
                >
                  {item.label}
                </a>
              </li>
            ))
          }
        </ul>
        <LanguageSelector lang={lang} />
      </nav>
    </div>
  </div>
</header>

<script is:inline>
  document.addEventListener("DOMContentLoaded", () => {
    const toggle = document.getElementById("menu-toggle");
    const menu = document.getElementById("main-menu");
    if (toggle && menu) {
      toggle.addEventListener("click", (e) => {
        e.stopPropagation();
        menu.classList.toggle("hidden");
      });
      document.querySelectorAll(".menu-link").forEach((link) => {
        link.addEventListener("click", () => {
          menu.classList.add("hidden");
        });
      });
      document.addEventListener("click", (e) => {
        if (
          !menu.classList.contains("hidden") &&
          !menu.contains(e.target) &&
          e.target !== toggle
        ) {
          menu.classList.add("hidden");
        }
      });
    }
  });
</script>
